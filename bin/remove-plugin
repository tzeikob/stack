#!/usr/bin/env sh

clear

selection=${NNN_SEL:-${XDG_CONFIG_HOME:-$HOME/.config}/nnn/.selection}

printf "(s)election/(c)urrent? [default=c] "
read -r resp

# Convert selection into an array
if [ "$resp" = "s" ]; then
  files=$(tr '\0' '\n' < "$selection")
else
  files=$1
fi

printf "\nFile(s) will be gone forever:\n"

for entry in $files
do
  printf "$entry\n"
done

printf "Do you want to proceed? [y/N] "
read -r confirm

if [ "$confirm" = "y" ] || [ "$confirm" = "Y" ]; then
  rm -rf $files
fi

# Clear selection
if [ "$resp" = "s" ] && [ -p "$NNN_PIPE" ]; then
  printf "-" > "$NNN_PIPE"
fi
